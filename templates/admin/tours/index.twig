{% extends 'admin/layout.twig' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-3">
    <h1>Туры</h1>
    <a class="btn btn-primary" href="/admin/tours/create">Добавить тур</a>
</div>

<div class="table-responsive">
    <table class="table table-striped align-middle">
        <thead>
        <tr>
            <th>ID</th>
            <th>Название</th>
            <th>Локация</th>
            <th>Цена</th>
            <th>Даты</th>
            <th></th>
        </tr>
        </thead>
        <tbody id="tours-table">
        {% for t in tours %}
            <tr>
                <td>{{ t.id }}</td>
                <td>{{ t.title|e }}</td>
                <td>{{ t.country|e }}, {{ t.region|e }}, {{ t.city|e }}</td>
                <td>{{ t.price|e }}</td>
                <td>{{ t.start_date|e }} — {{ t.end_date|e }}</td>
                <td class="text-end">
                    <a class="btn btn-sm btn-outline-secondary" href="/admin/tours/{{ t.id }}/edit">Редактировать</a>
                    <button class="btn btn-sm btn-outline-danger js-delete" data-id="{{ t.id }}">Удалить</button>
                </td>
            </tr>
        {% else %}
            <tr><td colspan="6" class="text-center text-muted">Нет записей</td></tr>
        {% endfor %}
        </tbody>
    </table>
</div>

<form id="delete-form" method="post" style="display:none"></form>

{% endblock %}

{% block scripts %}
<script>
$(function(){
  $('#tours-table').on('click', '.js-delete', function(){
    const id = $(this).data('id');
    if (!confirm('Удалить запись #' + id + '?')) return;
    const form = $('#delete-form');
    form.attr('action', '/admin/tours/' + id + '/delete');
    form.submit();
  });
});
</script>
{% endblock %}

